pipeline:
  build:
    image: golang
    secrets: [ artifactory_password, ARTIFACTORY_USER, ARTIFACTORY_URL, go_repo_key ]
    commands:
    # Download the JFrog CLI 
      - echo $GOPATH
      - go get -u golang.org/x/vgo
      - export vgo=$GOPATH/bin/vgo
      - cd hello
      - curl -fL https://getcli.jfrog.io | sh
      - ./jfrog rt config --url=$ARTIFACTORY_URL --user=$ARTIFACTORY_USER --password=$ARTIFACTORY_PASSWORD
      - ./jfrog rt c show
      - sed -i 's,go_repo_key,'"$go_repo_key"',g' ../configuration.yml
      - ./jfrog rt go build --no-registry
      - ./jfrog rt gp go --self=false --deps=ALL
      - ./jfrog rt bce Drone_GO_demo 1.1.0
      - ./jfrog rt bp Drone_GO_demo 1.1.0



